@model List<Models.Common.Organization>
@{
    ViewBag.Title = "Organization Management Home";
}

@Html.Partial( "~/Views/Shared/Management/_SearchCore.cshtml" )
@*@Scripts.Render( "~/bundles/jqueryui" )
<link href="~/Styles/jquery-ui.css" rel="stylesheet" />*@
<script type="text/javascript">

    $(document).ready(function () {
        $(function () {
            $('#reset').click(function () {
                $('#Keyword').val('')
            });
        });

        $("#Keyword").autocomplete({
            minLength: 3,
            source: function (request, response) {
                $.ajax({
                    url: "@Url.Content( "~/OrganizationManagement/List" )",
                    type: "POST",
                    dataType: "json",
                    data: { keyword: request.term, maxTerms: 20 },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.name, value: item.Name };
                        }))
                    }
                })
            },

            messages: {
                noResults: "", results: ""
            }
        });
    })
</script>
<h1>Organization Management</h1>
@using ( Html.BeginForm() )
{
    <div id="searchContainer" class="form-horizontal">
        <div class="form-group">
            Keyword
            <div class="col-md-4">
                <input class="form-control ui-autocomplete-input" id="Keyword" name="Keyword" placeholder="Keyword(s), enter at least 3 letters" type="text" value="" autocomplete="off" style="width: 50%;" />
            </div>

        </div>
    </div>
    <div class="form-horizontal">
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Search" class="btn btn-default" />
                <input type="button" value="Clear" id="reset" class="btn btn-default" />
            </div>
        </div>
    </div>
}
<div id="buttons">
@if ( AccountServices.CanUserPublishContent() )
{
	<a class="linkButton" href="@Url.Content("~/OrganizationManagement/Edit")">Create new Organization</a>
}
</div>
<div style="margin: 5px;">

    @if ( Model.Count > 0 )
    {

        <div>
            <strong> @Model.Count organizations were found.</strong>
        </div>
    }
    else
    {
        <div>
            <i>Sorry no organizations were found.</i>
        </div>
    }
</div>

@foreach ( var item in Model )
{
	<div class="result" style="background-color: #FFF; color: #000;" data-resultID="@item.Id">
        <a class="title" style="display:inline-block;" href="@Url.Content("~/OrganizationManagement/Detail/")@item.Id" >@item.Name</a>
        @if ( item.IsACredentialingOrg )
        {
            <img style="display:inline-block; width: 25px;" src="~/Images/Icons/icon_credential.png" />
        }
        @if ( item.IsAQAOrg )
        {
            <img style="display:inline-block;" src="~/Images/Icons/icon_QAOrg.png" />
        }
		<div class="description">@item.Description</div>
		<div class="controls">
			<div class="date">@item.LastUpdated.ToShortDateString()</div>
            @if (AccountServices.CanUserPublishContent()) 
            {
			<a class="editLink linkButton" href="@Url.Content("~/OrganizationManagement/Edit/")@item.Id">Edit</a>
			<input type="button" class="btnDelete" value="Delete" onclick="deleteResult('@item.Name', @item.Id, 'Credential', 'credentialmanagement');" />
}
		</div>
	</div>
}

